<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking Experience</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.294.0/dist/umd/lucide.min.js"></script>

    <style>
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1rem;
        }

        .section {
            margin-bottom: 2rem;
        }
    </style>
</head>

<body class="bg-gray-100">
    <div x-data x-init="setTimeout(() => lucide.createIcons(), 0)">

        <!-- Option 1: Using JavaScript to load components -->
        <!-- <div id="booking-hero"></div> -->
        <!-- Header Section (Sticky with Price) -->
        <header class="bg-[#0a1e3c] text-white sticky top-0 z-50 shadow-md sticky top-0" x-data="{
    // Get the total from the global store
    get totalPrice() {
      return $store.booking.calculateTotal() + $store.booking.calculateTaxes();
    }
  }">
            <div class="container mx-auto py-3 px-4">
                <div class="flex justify-between items-center">
                    <div class="font-bold text-2xl">Hotelverse</div>
                    <div class="flex items-center space-x-4">
                        <div class="text-right">
                            <p class="text-xs text-gray-300">Total:</p>
                            <p class="text-base font-medium">€<span x-text="totalPrice.toFixed(2)"></span></p>
                        </div>
                        <div class="bg-white/10 p-2 rounded-full">
                            <i data-lucide="shopping-cart" class="h-6 w-6"></i>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Booking Information Bar with Sticky-to-Fixed Transition -->
        <div x-data="{ scrolled: false }"
            x-init="window.addEventListener('scroll', () => { scrolled = window.scrollY > 200 })">
            <!-- Hotel Image Banner - Always visible at the top of the page -->
            <section class="bg-white">
                <div class="w-full overflow-hidden h-64 container">
                    <img src="https://hvdataprostgweu.blob.core.windows.net/renderimages/h305/views/01_main/01d77a02-b92f-4214-a87c-79920dcbeded/background.webp"
                        alt="Hotel exterior view" class="w-full h-full object-cover rounded"
                        onerror="this.src='https://cdnjs.cloudflare.com/ajax/libs/placeholder-loading/0.6.0/img/background.jpg'">
                </div>
            </section>

            <!-- Normal Booking Bar (Non-scrolled) - Uses sticky positioning -->
            <div x-show="!scrolled" class="sticky top-0 z-40 bg-white shadow-md">
                <!-- Desktop version -->
                <div class="hidden md:block">
                    <div class="container mx-auto py-3">
                        <h4 class="ml-4 mb-2">Información de tu reserva</h4>
                        <div class="flex flex-wrap items-center justify-between px-4">
                            <!-- Reservation Code -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="tag" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Código de reserva</p>
                                    <p class="text-sm font-medium">1003066AU</p>
                                </div>
                            </div>

                            <!-- Stay Dates -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="calendar" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Fechas de estancia</p>
                                    <p class="text-sm font-medium">01/01/2025 - 01/01/2025</p>
                                </div>
                            </div>

                            <!-- Room Type -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="home" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Tipo de habitación</p>
                                    <p class="text-sm font-medium">Deluxe Double Room</p>
                                </div>
                            </div>

                            <!-- Status -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="check-circle" class="h-4 w-4 text-green-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Estado</p>
                                    <p class="text-sm font-medium text-green-600">Confirmado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile version - simplified for smaller screens -->
                <div class="block md:hidden">
                    <div class="container mx-auto py-3">
                        <div class="grid grid-cols-2 gap-2">
                            <!-- Reservation Code -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="tag" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Código</p>
                                    <p class="text-sm font-medium">1003066AU</p>
                                </div>
                            </div>

                            <!-- Status -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="check-circle" class="h-4 w-4 text-green-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Estado</p>
                                    <p class="text-sm font-medium text-green-600">Confirmado</p>
                                </div>
                            </div>

                            <!-- Stay Dates -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="calendar" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Fechas</p>
                                    <p class="text-sm font-medium">01/01/2025 - 01/01/2025</p>
                                </div>
                            </div>

                            <!-- Room Type -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="home" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Habitación</p>
                                    <p class="text-sm font-medium">Deluxe Double</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fixed Booking Bar (Scrolled) - Uses fixed positioning -->
            <div x-show="scrolled" class="fixed top-0 left-0 right-0 z-50 bg-white shadow-md">
                <!-- Desktop version -->
                <div class="hidden md:block">
                    <div class="container mx-auto py-3">
                        <div class="flex flex-wrap items-center justify-between px-4">
                            <!-- Reservation Code -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="tag" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Código de reserva</p>
                                    <p class="text-sm font-medium">1003066AU</p>
                                </div>
                            </div>

                            <!-- Stay Dates -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="calendar" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Fechas de estancia</p>
                                    <p class="text-sm font-medium">01/01/2025 - 01/01/2025</p>
                                </div>
                            </div>

                            <!-- Room Type -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="home" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Tipo de habitación</p>
                                    <p class="text-sm font-medium">Deluxe Double Room</p>
                                </div>
                            </div>

                            <!-- Status -->
                            <div class="flex items-center gap-2 py-2">
                                <i data-lucide="check-circle" class="h-4 w-4 text-green-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Estado</p>
                                    <p class="text-sm font-medium text-green-600">Confirmado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile version - simplified for smaller screens -->
                <div class="block md:hidden">
                    <div class="container mx-auto py-3">
                        <div class="grid grid-cols-2 gap-2">
                            <!-- Reservation Code -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="tag" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Código</p>
                                    <p class="text-sm font-medium">1003066AU</p>
                                </div>
                            </div>

                            <!-- Status -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="check-circle" class="h-4 w-4 text-green-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Estado</p>
                                    <p class="text-sm font-medium text-green-600">Confirmado</p>
                                </div>
                            </div>

                            <!-- Stay Dates -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="calendar" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Fechas</p>
                                    <p class="text-sm font-medium">01/01/2025 - 01/01/2025</p>
                                </div>
                            </div>

                            <!-- Room Type -->
                            <div class="flex items-center gap-2 px-2 py-1">
                                <i data-lucide="home" class="h-4 w-4 text-gray-600"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Habitación</p>
                                    <p class="text-sm font-medium">Deluxe Double</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Placeholder div to prevent content jump when the booking bar becomes fixed -->
            <div x-show="scrolled" class="h-16 md:h-20"></div>
        </div>
        <section class="grid grid-cols-1 md:grid-cols-[1fr_400px] container gap-4">
            <div class="">
                <!-- Room Selection Component with Clear Side Cards -->
                <div class="section bg-white p-6 rounded-lg shadow-sm" x-data="{
    selectedRoom: $store.booking.selectedRoom,
    activeIndex: 1, // Start with middle card active
    activeImageIndices: {
      0: 0,
      1: 0,
      2: 0
    },
    proposedPrice: 12, // Default proposed price
    minPrice: 10, // Minimum price for slider
    get maxPrice() {
      return this.roomOptions[this.activeIndex]?.price || 20;
    },
    get sliderPercentage() {
      return ((this.proposedPrice - this.minPrice) / (this.maxPrice - this.minPrice)) * 100;
    },
    roomOptions: [
    {
        id: 'habitacion-moderna',
        name: 'Habitación Moderna',
        description: 'Espacio contemporáneo con diseño minimalista y tecnología inteligente.',
        amenities: ['Smart TV', 'Ducha efecto lluvia', 'Minibar', 'WiFi Premium'],
        price: 105,
        oldPrice: 125,
        images: [
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp'
        ],
      },
      {
        id: 'habitacion-real',
        name: 'Habitación Real',
        description: 'Habitación de lujo con balcón privado, área de descanso y servicios exclusivos.',
        amenities: ['Cama amplia', 'Vista marítima', 'Terraza privada', 'Sala de estar'],
        price: 123,
        images: [
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp'
        ],
      },
      {
        id: 'suite-deluxe',
        name: 'Suite Deluxe',
        description: 'Suite de lujo con balcón privado, vistas al océano y servicios exclusivos.',
        amenities: ['Cama King Size', 'Panorama oceánico', 'Terraza privada', 'Baño elegante'],
        price: 150,
        oldPrice: 180,
        images: [
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp',
          'https://hvdatauatstgweu.blob.core.windows.net/roomtypehotelimages/h70/rt726/53a88e60-a2a5-4a19-b435-a0d8958efff4/thumbnail.webp'
        ],
      }
    ],
    prevImage(index) {
      this.activeImageIndices[index] = this.activeImageIndices[index] > 0 
        ? this.activeImageIndices[index] - 1 
        : this.roomOptions[index].images.length - 1;
    },
    nextImage(index) {
      this.activeImageIndices[index] = (this.activeImageIndices[index] + 1) % this.roomOptions[index].images.length;
    },
    prevSlide() {
      this.activeIndex = this.activeIndex > 0 ? this.activeIndex - 1 : this.roomOptions.length - 1;
    },
    nextSlide() {
      this.activeIndex = (this.activeIndex + 1) % this.roomOptions.length;
    },
    setSlide(index) {
      this.activeIndex = index;
      // Update proposed price when switching rooms
      this.proposedPrice = Math.round((this.minPrice + this.maxPrice) / 2);
    },
    selectRoom(room) {
      // Update the local state
      this.selectedRoom = room;
      
      // Update the global state
      $store.booking.selectRoom(room);
    },
    makeOffer() {
      alert('Has propuesto ' + this.proposedPrice + ' EUR por noche');
    },
    init() {
      // Watch for changes in the global store
      this.$watch('$store.booking.selectedRoom', (value) => {
        this.selectedRoom = value;
      });
    }
  }">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">¿Quieres una habitación superior?</h2>
                        <p class="text-gray-600">
                            En lugar de hospedarte en una <span class="font-bold">Habitación Deluxe</span>, ¿por qué no
                            elegir una con
                            <span class="font-bold">Vista al Océano</span>?
                        </p>
                    </div>

                    <div class="lg:col-span-2">
                        <!-- Slider Container with Visible Cards -->
                        <div class="relative w-full overflow-visible" style="height: 550px;">
                            <!-- Main Carousel Area -->
                            <style>
                                .card-carousel {
                                    width: 100%;
                                    position: relative;
                                    perspective: 1000px;
                                    height: 550px;
                                    overflow: hidden;
                                }

                                .card-container {
                                    width: 50%;
                                    position: absolute;
                                    transition: all 0.5s ease;
                                }

                                .card-container.active {
                                    top: 5px;
                                    left: 25%;
                                    z-index: 10;
                                }

                                .card-container.prev {
                                    left: -30%;
                                    z-index: 5;
                                    opacity: 0.7;
                                }

                                .card-container.next {
                                    left: 80%;
                                    z-index: 5;
                                    opacity: 0.7;
                                }

                                .badge-discount {
                                    position: absolute;
                                    top: 12px;
                                    right: 12px;
                                    background-color: #000;
                                    color: white;
                                    padding: 4px 8px;
                                    border-radius: 4px;
                                    font-weight: bold;
                                    font-size: 12px;
                                    z-index: 10;
                                }
                            </style>

                            <div class="card-carousel">
                                <!-- First Card (Left) -->
                                <div class="card-container"
                                    :class="{'active': activeIndex === 0, 'prev': activeIndex === 1, 'next': activeIndex === 2}"
                                    @click="setSlide(0)">
                                    <!-- Using Third Card Design -->
                                    <div class="border rounded-lg overflow-hidden shadow-sm bg-white h-full">
                                        <!-- Discount Badge -->
                                        <div class="badge-discount" x-show="roomOptions[0].oldPrice">
                                            <span
                                                x-text="`-${Math.round((1 - roomOptions[0].price/roomOptions[0].oldPrice) * 100)}%`"></span>
                                        </div>

                                        <!-- Room Image Carousel -->
                                        <div class="relative h-64 bg-gray-100">
                                            <img :src="roomOptions[0].images[activeImageIndices[0]]"
                                                :alt="roomOptions[0].name" class="object-cover w-full h-full" />

                                            <!-- Image Indicators -->
                                            <div class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1">
                                                <template x-for="(_, imgIndex) in roomOptions[0].images"
                                                    :key="imgIndex">
                                                    <span class="block h-2 w-2 rounded-full"
                                                        :class="activeImageIndices[0] === imgIndex ? 'bg-white' : 'bg-white/50'"></span>
                                                </template>
                                            </div>
                                        </div>

                                        <!-- Room Details -->
                                        <div class="p-4">
                                            <h3 class="text-xl font-bold text-gray-800 mb-1"
                                                x-text="roomOptions[0].name"></h3>
                                            <p class="text-sm text-gray-600 mb-3 min-h-10"
                                                x-text="roomOptions[0].description"></p>

                                            <!-- Amenities -->
                                            <div class="flex flex-nowrap gap-2 mb-3 w-full overflow-auto">
                                                <template x-for="(amenity, amenityIndex) in roomOptions[0].amenities"
                                                    :key="amenityIndex">
                                                    <span
                                                        class="text-xs border border-gray-200 px-3 py-1 rounded-md text-nowrap"
                                                        x-text="amenity"></span>
                                                </template>
                                            </div>

                                            <!-- Price Display -->
                                            <div class="flex items-center gap-2 mb-3">
                                                <span class="text-2xl font-bold"
                                                    x-text="'€' + roomOptions[0].price"></span>
                                                <span class="text-gray-500 line-through text-sm"
                                                    x-show="roomOptions[0].oldPrice"
                                                    x-text="'€' + roomOptions[0].oldPrice"></span>
                                                <span class="text-sm text-gray-500">/noche</span>
                                            </div>

                                            <!-- Action Buttons -->
                                            <div class="flex items-center gap-4 mt-3">
                                                <button
                                                    class="px-6 py-2.5 text-sm font-medium rounded-md uppercase tracking-wide transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black"
                                                    :class="selectedRoom?.id === roomOptions[0].id ? 'bg-green-600 text-white shadow-md' : 'bg-black text-white hover:bg-gray-800'"
                                                    @click.stop="selectRoom(roomOptions[0])">
                                                    <span
                                                        x-text="selectedRoom?.id === roomOptions[0].id ? 'SELECCIONADO' : 'SELECCIONAR'"></span>
                                                </button>

                                                <button class="text-sm text-gray-500 underline">
                                                    Descubre más detalles
                                                </button>
                                            </div>

                                            <!-- Additional Info -->
                                            <p class="text-xs text-gray-500 mt-4">Información sobre tarifas e impuestos.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Second Card (Middle) -->
                                <div class="card-container"
                                    :class="{'active': activeIndex === 1, 'prev': activeIndex === 2, 'next': activeIndex === 0}"
                                    @click="setSlide(1)">
                                    <!-- Using Third Card Design -->
                                    <div class="border rounded-lg overflow-hidden shadow-sm bg-white h-full">
                                        <!-- Room Image Carousel -->
                                        <div class="relative h-64 bg-gray-100">
                                            <img :src="roomOptions[1].images[activeImageIndices[1]]"
                                                :alt="roomOptions[1].name" class="object-cover w-full h-full" />

                                            <!-- Image Indicators -->
                                            <div class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1">
                                                <template x-for="(_, imgIndex) in roomOptions[1].images"
                                                    :key="imgIndex">
                                                    <span class="block h-2 w-2 rounded-full"
                                                        :class="activeImageIndices[1] === imgIndex ? 'bg-white' : 'bg-white/50'"></span>
                                                </template>
                                            </div>
                                        </div>

                                        <!-- Room Details -->
                                        <div class="p-4">
                                            <h3 class="text-xl font-bold text-gray-800 mb-1"
                                                x-text="roomOptions[1].name"></h3>
                                            <p class="text-sm text-gray-600 mb-3 min-h-10"
                                                x-text="roomOptions[1].description"></p>

                                            <!-- Amenities -->
                                            <div class="flex flex-nowrap gap-2 mb-3 w-full overflow-auto">
                                                <template x-for="(amenity, amenityIndex) in roomOptions[1].amenities"
                                                    :key="amenityIndex">
                                                    <span
                                                        class="text-xs border border-gray-200 px-3 py-1 rounded-md text-nowrap"
                                                        x-text="amenity"></span>
                                                </template>
                                            </div>

                                            <!-- Price Display -->
                                            <div class="flex items-center gap-2 mb-3">
                                                <span class="text-2xl font-bold"
                                                    x-text="'€' + roomOptions[1].price"></span>
                                                <span class="text-sm text-gray-500">/noche</span>
                                            </div>

                                            <!-- Action Buttons -->
                                            <div class="flex items-center gap-4 mt-3">
                                                <button
                                                    class="px-6 py-2.5 text-sm font-medium rounded-md uppercase tracking-wide transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black"
                                                    :class="selectedRoom?.id === roomOptions[1].id ? 'bg-green-600 text-white shadow-md' : 'bg-black text-white hover:bg-gray-800'"
                                                    @click.stop="selectRoom(roomOptions[1])">
                                                    <span
                                                        x-text="selectedRoom?.id === roomOptions[1].id ? 'SELECCIONADO' : 'SELECCIONAR'"></span>
                                                </button>

                                                <button class="text-sm text-gray-500 underline">
                                                    Descubre más detalles
                                                </button>
                                            </div>

                                            <!-- Additional Info -->
                                            <p class="text-xs text-gray-500 mt-4">Información sobre tarifas e impuestos.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Third Card (Right) - Original Design -->
                                <div class="card-container"
                                    :class="{'active': activeIndex === 2, 'prev': activeIndex === 0, 'next': activeIndex === 1}"
                                    @click="setSlide(2)">
                                    <div class="border rounded-lg overflow-hidden shadow-sm bg-white h-full">
                                        <!-- Room Image Carousel -->
                                        <div class="relative h-64 bg-gray-100">
                                            <img :src="roomOptions[2].images[activeImageIndices[2]]"
                                                :alt="roomOptions[2].name" class="object-cover w-full h-full" />

                                            <!-- Image Indicators -->
                                            <div class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1">
                                                <template x-for="(_, imgIndex) in roomOptions[2].images"
                                                    :key="imgIndex">
                                                    <span class="block h-2 w-2 rounded-full"
                                                        :class="activeImageIndices[2] === imgIndex ? 'bg-white' : 'bg-white/50'"></span>
                                                </template>
                                            </div>
                                        </div>

                                        <!-- Room Details -->
                                        <div class="p-4">
                                            <h3 class="text-xl font-bold text-gray-800 mb-1"
                                                x-text="roomOptions[2].name"></h3>
                                            <p class="text-sm text-gray-600 mb-3 min-h-10"
                                                x-text="roomOptions[2].description"></p>

                                            <!-- Amenities -->
                                            <div class="flex flex-nowrap gap-2 mb-3 w-full overflow-auto">
                                                <template x-for="(amenity, amenityIndex) in roomOptions[2].amenities"
                                                    :key="amenityIndex">
                                                    <span
                                                        class="text-xs border border-gray-200 px-3 py-1 rounded-md text-nowrap"
                                                        x-text="amenity"></span>
                                                </template>
                                            </div>

                                            <!-- Price Display -->
                                            <div class="flex items-center gap-2 mb-3">
                                                <span class="text-2xl font-bold"
                                                    x-text="'€' + roomOptions[2].price"></span>
                                                <span class="text-gray-500 line-through text-sm"
                                                    x-show="roomOptions[2].oldPrice"
                                                    x-text="'€' + roomOptions[2].oldPrice"></span>
                                                <span class="text-sm text-gray-500">/noche</span>
                                            </div>

                                            <!-- Action Buttons -->
                                            <div class="flex items-center gap-4 mt-3">
                                                <button
                                                    class="px-6 py-2.5 text-sm font-medium rounded-md uppercase tracking-wide transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black"
                                                    :class="selectedRoom?.id === roomOptions[2].id ? 'bg-green-600 text-white shadow-md' : 'bg-black text-white hover:bg-gray-800'"
                                                    @click.stop="selectRoom(roomOptions[2])">
                                                    <span
                                                        x-text="selectedRoom?.id === roomOptions[2].id ? 'SELECCIONADO' : 'SELECCIONAR'"></span>
                                                </button>

                                                <button class="text-sm text-gray-500 underline">
                                                    Descubre más detalles
                                                </button>
                                            </div>

                                            <!-- Additional Info -->
                                            <p class="text-xs text-gray-500 mt-4">Información sobre tarifas e impuestos.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Arrow Navigation Controls -->
                            <button @click="prevSlide"
                                class="absolute left-0 top-1/2 -translate-y-1/2 z-20 bg-white rounded-full shadow-md p-2 ml-2 transition-all duration-200 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2"
                                aria-label="Previous room">
                                <i data-lucide="chevron-left" class="h-6 w-6"></i>
                            </button>

                            <button @click="nextSlide"
                                class="absolute right-0 top-1/2 -translate-y-1/2 z-20 bg-white rounded-full shadow-md p-2 mr-2 transition-all duration-200 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2"
                                aria-label="Next room">
                                <i data-lucide="chevron-right" class="h-6 w-6"></i>
                            </button>
                        </div>

                        <!-- Price Slider Below Carousel -->
                        <div class="mt-1 mb-6 w-1/2 mx-auto border rounded-lg p-4">
                            <div class="text-sm font-medium mb-2 flex justify-between items-center">
                                <span>Propon tu precio:</span>
                                <span x-text="proposedPrice + ' EUR/noche'" class="text-black font-bold"></span>
                            </div>
                            <div class="relative w-full">
                                <style>
                                    /* Custom styling for range input */
                                    input[type="range"] {
                                        -webkit-appearance: none;
                                        width: 100%;
                                        height: 8px;
                                        border-radius: 5px;
                                        background: #e5e7eb;
                                        /* gray-200 */
                                        outline: none;
                                    }

                                    /* Thumb styling */
                                    input[type="range"]::-webkit-slider-thumb {
                                        -webkit-appearance: none;
                                        appearance: none;
                                        width: 20px;
                                        height: 20px;
                                        border-radius: 50%;
                                        background: white;
                                        border: 2px solid black;
                                        cursor: pointer;
                                        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
                                    }

                                    input[type="range"]::-moz-range-thumb {
                                        width: 20px;
                                        height: 20px;
                                        border-radius: 50%;
                                        background: white;
                                        border: 2px solid black;
                                        cursor: pointer;
                                        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
                                    }

                                    /* Track progress fill effect */
                                    input[type="range"] {
                                        background: linear-gradient(to right,
                                                black 0%,
                                                black calc((var(--value) - var(--min)) / (var(--max) - var(--min)) * 100%),
                                                #e5e7eb calc((var(--value) - var(--min)) / (var(--max) - var(--min)) * 100%),
                                                #e5e7eb 100%);
                                    }
                                </style>
                                <input type="range" :min="minPrice" :max="maxPrice" step="1"
                                    x-model.number="proposedPrice"
                                    x-init="$el.style.setProperty('--value', proposedPrice); $el.style.setProperty('--min', minPrice); $el.style.setProperty('--max', maxPrice)"
                                    @input="$el.style.setProperty('--value', proposedPrice)"
                                    x-effect="$el.style.setProperty('--min', minPrice); $el.style.setProperty('--max', maxPrice)"
                                    class="w-full" />
                                <div class="w-full flex justify-between text-xs text-gray-500 mt-2">
                                    <span x-text="minPrice + ' EUR/noche'"></span>
                                    <span x-text="maxPrice + ' EUR/noche'"></span>
                                </div>
                            </div>
                            <button
                                class="w-full mt-3 py-2 bg-black hover:bg-gray-900 text-white rounded-md transition duration-200"
                                @click="makeOffer()">
                                Hacer oferta
                            </button>
                            <p class="text-xs text-gray-500 mt-1 text-center">Sujeto a disponibilidad</p>
                        </div>
                    </div>
                </div>
                <!-- Room Customization Component -->
                <div class="section rounded-lg shadow-sm mt-6" x-data="{
    openSections: {
      camas: true,
      ubicacion: true,
      vista: true,
      piso: true
    },
  
    toggleSection(section) {
      this.openSections[section] = !this.openSections[section];
    },
    openModal(modalId) {
      console.log(modalId)
      this.$refs[modalId].showModal();
    },
    openFloorModal(modalId) {
      this.$refs[modalId].showModal();
    },
    get selectedOptions() {
      // Create a mapping of category to selected ID
      const selections = {};
      Object.entries($store.booking.customizations).forEach(([category, option]) => {
        selections[category] = option ? option.id : '';
      });
      return selections;
    },
    sectionInfo: {
      camas: 'Elige el tipo de cama que prefieras para tu estancia. Cada opción ofrece diferentes niveles de comodidad y espacio según tus necesidades. Las camas king-size son ideales para parejas que desean más espacio, mientras que las camas individuales son perfectas para amigos o familiares.',
      ubicacion: 'La ubicación de tu habitación puede afectar significativamente tu experiencia. Las habitaciones en esquina ofrecen más privacidad, mientras que las suites con vista al mar te brindan panoramas impresionantes del océano. Elige la ubicación que mejor se adapte a tus preferencias.',
      vista: 'Selecciona la vista exacta desde tu habitación. Cada opción ofrece una perspectiva única del entorno del hotel, desde vistas panorámicas de la ciudad hasta impresionantes amaneceres sobre el mar.',
      piso: 'El piso en el que se encuentra tu habitación puede influir en la vista, el ruido y la accesibilidad. Los pisos superiores ofrecen mejores vistas y menos ruido, mientras que los pisos inferiores proporcionan un acceso más rápido a las instalaciones del hotel.'
    },
    bedsOptions: [
      {
        id: 'king',
        icon: 'bed',
        label: 'Cama tamaño king',
        description: 'Habitación libre de humo',
        price: 9.00
      },
      {
        id: 'twin',
        icon: 'bed',
        label: 'Dos camas individuales',
        description: 'Habitación sin humo',
        price: 0.00
      },
      {
        id: 'queen',
        icon: 'bed',
        label: 'Cama tamaño queen',
        description: 'Habitación para fumadores',
        price: 5.00
      },
      {
        id: 'suite',
        icon: 'hotel',
        label: 'Suite de lujo',
        description: 'Habitación libre de humo',
        price: 15.00
      }
    ],
    locationOptions: [
      {
        id: 'main',
        icon: 'building',
        label: 'En el edificio principal',
        description: 'Habitación estándar',
        price: 0.00
      },
      {
        id: 'corner',
        icon: 'corner-up-right',
        label: 'Habitación de esquina',
        description: 'Vista panorámica',
        price: 5.00
      },
      {
        id: 'sea',
        icon: 'waves',
        label: 'Suite con vista al mar',
        description: 'Vista al océano',
        price: 9.00
      },
      {
        id: 'rooftop',
        icon: 'home',
        label: 'Suite en la azotea',
        description: 'Vista panorámica',
        price: 12.00
      },
      {
        id: 'rooftop1',
        icon: 'home',
        label: 'Suite en la azotea1',
        description: 'Vista panorámica1',
        price: 15.00
      }
    ],
    viewOptions: [
      { id: 'view1', label: 'Vista al jardín', price: 0.00 },
      { id: 'view2', label: 'Vista a la piscina', price: 5.00 },
      { id: 'view3', label: 'Vista a la calle', price: 0.00 },
      { id: 'view4', label: 'Vista al océano', price: 10.00 },
      { id: 'view5', label: 'Vista a la montaña', price: 7.00 },
      { id: 'view6', label: 'Vista al atardecer', price: 8.00 }
    ],
    floorOptions: [
      {
        id: 'ground',
        icon: 'layout',
        label: 'Planta baja',
        description: 'Fácil acceso',
        price: 0.00
      },
      {
        id: 'middle',
        icon: 'layers',
        label: 'Pisos intermedios',
        description: 'Balance perfecto',
        price: 3.00
      },
      {
        id: 'high',
        icon: 'arrow-up',
        label: 'Pisos superiores',
        description: 'Mejor vista',
        price: 6.00
      },
      {
        id: 'penthouse',
        icon: 'home',
        label: 'Penthouse',
        description: 'Experiencia premium',
        price: 20.00
      }
    ],
    handleSelect(category, id) {
      // Find the option details
      let optionDetails;
      let price = 0;
      let label = '';
      
      switch(category) {
        case 'camas':
          optionDetails = this.bedsOptions.find(o => o.id === id);
          break;
        case 'ubicacion':
          optionDetails = this.locationOptions.find(o => o.id === id);
          break;
        case 'piso':
          optionDetails = this.floorOptions.find(o => o.id === id);
          break;
        case 'vista':
          optionDetails = this.viewOptions.find(o => o.id === id);
          break;
      }
      
      if (optionDetails) {
        price = optionDetails.price;
        label = optionDetails.label;
      }
      
      // Toggle the selection using the global state
      const currentSelectedId = this.selectedOptions[category];
      
      if (currentSelectedId === id) {
        // If already selected, deselect it
        $store.booking.toggleCustomization(category, '', 0, '');
      } else {
        // Otherwise select the new option
        $store.booking.toggleCustomization(category, id, price, label);
      }
    },
    
    init() {
      // No longer needed to watch for changes since we're using a getter
    }
  }">
                    <div class="rounded-lg">
                        <div class="px-4 py-6 bg-white mb-6 rounded-md">
                            <h1 class="text-3xl font-bold text-gray-900 mb-2">Personaliza tu Habitación Deluxe!</h1>
                            <p class="text-gray-600">
                                Descubre nuestras opciones exclusivas de personalización para una estancia inolvidable.
                            </p>
                        </div>

                        <!-- Camas Section -->
                        <div class="mb-6 bg-white rounded-md overflow-hidden border">
                            <div class="flex justify-between items-center px-4 py-3 border-b cursor-pointer"
                                @click="toggleSection('camas')">
                                <div class="flex items-center">
                                    <h2 class="text-xl font-semibold text-gray-800">Camas</h2>
                                    <button @click.stop="openModal('camas')"
                                        class="ml-2 text-gray-500 hover:text-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="text-gray-400">
                                    <span class="text-2xl" x-text="openSections.camas ? '−' : '+'"></span>
                                </button>
                            </div>

                            <div x-show="openSections.camas" x-transition:enter="transition ease-out duration-300"
                                x-transition:enter-start="opacity-0 transform -translate-y-4"
                                x-transition:enter-end="opacity-100 transform translate-y-0"
                                x-transition:leave="transition ease-in duration-300"
                                x-transition:leave-start="opacity-100 transform translate-y-0"
                                x-transition:leave-end="opacity-0 transform -translate-y-4"
                                class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4">
                                <template x-for="option in bedsOptions" :key="option.id">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="p-4">
                                            <div class="flex flex-col mb-1">
                                                <div class="flex gap-2.5 items-center w-20">
                                                    <img src="https://cdn.builder.io/api/v1/image/assets/cdb357f47dc342a99db9a4132e4c6871/96b3a3585c1c453631b2ddc1d2f2323d3f1822a7f54f182cca2d886bd2f0373a?placeholderIfAbsent=true"
                                                        alt="Room icon"
                                                        class="object-contain self-stretch my-auto w-12 aspect-square" />
                                                </div>
                                                <h3 class="font-medium text-gray-900 text-sm" x-text="option.label">
                                                </h3>
                                            </div>
                                            <p class="text-xs text-gray-500 mb-1" x-text="option.description"></p>
                                            <p class="text-sm font-semibold mb-4"
                                                x-text="`${option.price.toFixed(2)}EUR/noche`"></p>
                                            <button @click="handleSelect('camas', option.id)"
                                                class="w-full py-2 text-center text-xs font-medium rounded transition-all duration-300"
                                                :class="selectedOptions.camas === option.id ? 
                  'bg-gray-800/90 text-white  ring-2 ring-black/10 ring-offset-2' : 
                  'bg-gray-800 text-white hover:bg-gray-800 hover:translate-y-[-2px] shadow-sm hover:shadow-md'">
                                                <span
                                                    x-text="selectedOptions.camas === option.id ? 'Seleccionado' : 'Mejorar'"></span>
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Ubicación Section -->
                        <div class="mb-6 bg-white rounded-md overflow-hidden border">
                            <div class="flex justify-between items-center px-4 py-3 border-b cursor-pointer"
                                @click="toggleSection('ubicacion')">
                                <div class="flex items-center">
                                    <h2 class="text-xl font-semibold text-gray-800">Ubicación</h2>
                                    <button @click.stop="openModal('ubicacion')"
                                        class="ml-2 text-gray-500 hover:text-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="text-gray-400">
                                    <span class="text-2xl" x-text="openSections.ubicacion ? '−' : '+'"></span>
                                </button>
                            </div>

                            <div x-show="openSections.ubicacion" x-transition:enter="transition ease-out duration-300"
                                x-transition:enter-start="opacity-0 transform -translate-y-4"
                                x-transition:enter-end="opacity-100 transform translate-y-0"
                                x-transition:leave="transition ease-in duration-300"
                                x-transition:leave-start="opacity-100 transform translate-y-0"
                                x-transition:leave-end="opacity-0 transform -translate-y-4"
                                class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4">
                                <template x-for="option in locationOptions" :key="option.id">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="p-4">
                                            <div class="flex flex-col mb-1">
                                                <div class="flex gap-2.5 items-center w-20">
                                                    <i :data-lucide="option.icon" class="h-10 w-10 text-gray-700"></i>
                                                </div>
                                                <h3 class="font-medium text-gray-900 text-sm" x-text="option.label">
                                                </h3>
                                            </div>
                                            <p class="text-xs text-gray-500 mb-1" x-text="option.description"></p>
                                            <p class="text-sm font-semibold mb-4"
                                                x-text="`${option.price.toFixed(2)}EUR/noche`"></p>
                                            <button @click="handleSelect('ubicacion', option.id)"
                                                class="w-full py-2 text-center text-xs font-medium rounded transition-all duration-300"
                                                :class="selectedOptions.ubicacion === option.id ? 
                  'bg-gray-800/90 text-white  ring-2 ring-[#0a1e3c]/10 ring-offset-2' : 
                  'bg-gray-800 text-white hover:bg-[#132d54] hover:translate-y-[-2px] shadow-sm hover:shadow-md'">
                                                <span
                                                    x-text="selectedOptions.ubicacion === option.id ? 'Seleccionado' : 'Mejorar'"></span>
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Floor Section -->
                        <div class="mb-6 bg-white rounded-md overflow-hidden border">
                            <div class="flex justify-between items-center px-4 py-3 border-b cursor-pointer"
                                @click="toggleSection('piso')">
                                <div class="flex items-center">
                                    <h2 class="text-xl font-semibold text-gray-800">Piso</h2>
                                    <button @click.stop="openModal('piso')"
                                        class="ml-2 text-gray-500 hover:text-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="text-gray-400">
                                    <span class="text-2xl" x-text="openSections.piso ? '−' : '+'"></span>
                                </button>
                            </div>

                            <div x-show="openSections.piso" x-transition:enter="transition ease-out duration-300"
                                x-transition:enter-start="opacity-0 transform -translate-y-4"
                                x-transition:enter-end="opacity-100 transform translate-y-0"
                                x-transition:leave="transition ease-in duration-300"
                                x-transition:leave-start="opacity-100 transform translate-y-0"
                                x-transition:leave-end="opacity-0 transform -translate-y-4"
                                class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4">
                                <template x-for="option in floorOptions" :key="option.id">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="p-4">
                                            <div class="flex flex-col mb-1">
                                                <div class="flex gap-2.5 items-center w-20">
                                                    <i :data-lucide="option.icon" class="h-10 w-10 text-gray-700"></i>
                                                </div>
                                                <h3 class="font-medium text-gray-900 text-sm" x-text="option.label">
                                                </h3>
                                            </div>
                                            <p class="text-xs text-gray-500 mb-1" x-text="option.description"></p>
                                            <p class="text-sm font-semibold mb-4"
                                                x-text="`${option.price.toFixed(2)}EUR/noche`"></p>
                                            <div class="flex flex-col space-y-2">
                                                <button @click="handleSelect('piso', option.id)"
                                                    class="w-full py-2 text-center text-xs font-medium rounded transition-all duration-300"
                                                    :class="selectedOptions.piso === option.id ? 
                    'bg-gray-800/90 text-white  ring-2 ring-black/10 ring-offset-2' : 
                    'bg-gray-800 text-white hover:bg-gray-800 hover:translate-y-[-2px] shadow-sm hover:shadow-md'">
                                                    <span
                                                        x-text="selectedOptions.piso === option.id ? 'Seleccionado' : 'Mejorar'"></span>
                                                </button>
                                                <button @click.stop="openModal('piso')"
                                                    class="text-xs text-gray-600 hover:text-gray-800 underline transition-colors">
                                                    Características y ventajas
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Vista exacta Section (Keeping the original layout) -->
                        <div class="bg-white rounded-md overflow-hidden border">
                            <div class="flex justify-between items-center px-4 py-3 border-b cursor-pointer"
                                @click="toggleSection('vista')">
                                <div class="flex items-center">
                                    <h2 class="text-xl font-semibold text-gray-800">Vista exacta</h2>
                                </div>
                                <button class="text-gray-400">
                                    <span class="text-2xl" x-text="openSections.vista ? '−' : '+'"></span>
                                </button>
                            </div>

                            <div x-show="openSections.vista" x-transition:enter="transition ease-out duration-300"
                                x-transition:enter-start="opacity-0 transform -translate-y-4"
                                x-transition:enter-end="opacity-100 transform translate-y-0"
                                x-transition:leave="transition ease-in duration-300"
                                x-transition:leave-start="opacity-100 transform translate-y-0"
                                x-transition:leave-end="opacity-0 transform -translate-y-4"
                                class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4">
                                <template x-for="view in viewOptions" :key="view.id">
                                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="relative">
                                            <img src="https://picsum.photos/600/400"
                                                :alt="`Room view option - ${view.label}`"
                                                class="w-full h-56 object-cover" />
                                            <div class="absolute bottom-0 left-10 right-10 py-2 text-center">
                                                <button @click="handleSelect('vista', view.id)"
                                                    class="text-xs font-medium mb-4 p-3 rounded shadow transition-all duration-300"
                                                    :class="selectedOptions.vista === view.id ? 
                            'bg-white/90 text-gray-800 ring-2 ring-gray-400/10 ring-offset-2' : 
                            'bg-white text-gray-800 hover:bg-gray-100 hover:translate-y-[-2px] hover:shadow-md'">
                                                    <span
                                                        x-text="selectedOptions.vista === view.id ? 'Seleccionado' : `Añadir por ${view.price.toFixed(2)} EUR`"></span>
                                                </button>
                                            </div>
                                            <div
                                                class="absolute top-2 left-2 bg-gray-800/70 text-white text-xs px-2 py-1 rounded">
                                                <span x-text="view.label"></span>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>

                    <dialog id="dialog-camas" x-ref="camas" class="p-0 rounded-lg shadow-xl max-w-md w-full">
                        <div class="bg-white p-6 rounded-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-semibold">Información sobre Camas</h3>
                                <button onclick="document.querySelector('#dialog-camas').close()"
                                    class="text-gray-500 hover:text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div class="text-gray-600">
                                Elige el tipo de cama que prefieras para tu estancia. Cada opción ofrece diferentes
                                niveles de comodidad y
                                espacio según tus necesidades. Las camas king-size son ideales para parejas que desean
                                más espacio, mientras que
                                las camas individuales son perfectas para amigos o familiares.
                            </div>
                            <div class="mt-6">
                                <button onclick="document.querySelector('#dialog-camas').close()"
                                    class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
                                    Entendido
                                </button>
                            </div>
                        </div>
                    </dialog>

                    <dialog id="dialog-ubicacion" x-ref="ubicacion" class="p-0 rounded-lg shadow-xl max-w-md w-full">
                        <div class="bg-white p-6 rounded-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-semibold">Información sobre Ubicación</h3>
                                <button onclick="document.querySelector('#dialog-ubicacion').close()"
                                    class="text-gray-500 hover:text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div class="text-gray-600">
                                La ubicación de tu habitación puede afectar significativamente tu experiencia. Las
                                habitaciones en esquina
                                ofrecen más privacidad, mientras que las suites con vista al mar te brindan panoramas
                                impresionantes del océano.
                                Elige la ubicación que mejor se adapte a tus preferencias.
                            </div>
                            <div class="mt-6">
                                <button onclick="document.querySelector('#dialog-ubicacion').close()"
                                    class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
                                    Entendido
                                </button>
                            </div>
                        </div>
                    </dialog>

                    <dialog id="dialog-piso" x-ref="piso" class="p-0 rounded-lg shadow-xl max-w-md w-full">
                        <div class="bg-white p-6 rounded-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-semibold">Información sobre Piso</h3>
                                <button onclick="document.querySelector('#dialog-piso').close()"
                                    class="text-gray-500 hover:text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div class="text-gray-600">
                                El piso en el que se encuentra tu habitación puede influir en la vista, el ruido y la
                                accesibilidad. Los pisos
                                superiores ofrecen mejores vistas y menos ruido, mientras que los pisos inferiores
                                proporcionan un acceso más
                                rápido a las instalaciones del hotel.
                            </div>
                            <div class="mt-6">
                                <button onclick="document.querySelector('#dialog-piso').close()"
                                    class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
                                    Entendido
                                </button>
                            </div>
                        </div>
                    </dialog>

                    <!-- 
    <dialog id="dialog-ground-details" x-ref="ground-details" class="p-0 rounded-lg shadow-xl max-w-md w-full">
      <div class="bg-white p-6 rounded-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Planta Baja</h3>
          <button @click="$refs['ground-details'].close()" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="text-gray-700">
          <p class="mb-4">Ideal para huéspedes que prefieren evitar ascensores. Disfrute de un acceso rápido al lobby,
            restaurantes y áreas de piscina sin esperas.</p>
  
          <h4 class="font-medium text-gray-900 mb-2">Ventajas de la Planta Baja:</h4>
          <ul class="list-disc pl-5 space-y-1 text-sm mb-4">
            <li>Acceso directo al jardín y piscina</li>
            <li>Ideal para personas con movilidad reducida</li>
            <li>Fácil acceso a restaurantes y servicios</li>
            <li>Sin necesidad de ascensores o escaleras</li>
            <li>Llegada rápida a su habitación desde la recepción</li>
          </ul>
  
          <p class="text-sm italic">Perfecto para: Familias con niños pequeños, personas mayores o con movilidad reducida,
            y huéspedes que valoran la comodidad de acceso rápido.</p>
        </div>
        <div class="mt-6">
          <button @click="$refs['ground-details'].close()"
            class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
            Cerrar
          </button>
        </div>
      </div>
    </dialog>
  
    <dialog id="dialog-middle-details" x-ref="middle-details" class="p-0 rounded-lg shadow-xl max-w-md w-full">
      <div class="bg-white p-6 rounded-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Pisos Intermedios</h3>
          <button @click="$refs['middle-details'].close()" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="text-gray-700">
          <p class="mb-4">Experimente la combinación ideal de tranquilidad y acceso conveniente. Estos pisos ofrecen
            buenas vistas panorámicas con un ambiente más sereno.</p>
  
          <h4 class="font-medium text-gray-900 mb-2">Ventajas de los Pisos Intermedios:</h4>
          <ul class="list-disc pl-5 space-y-1 text-sm mb-4">
            <li>Equilibrio perfecto entre vista y accesibilidad</li>
            <li>Menor nivel de ruido que en la planta baja</li>
            <li>Vistas panorámicas a la ciudad o área circundante</li>
            <li>Acceso rápido a todas las instalaciones</li>
            <li>Ideal para estancias prolongadas</li>
          </ul>
  
          <p class="text-sm italic">Perfecto para: Viajeros de negocios, parejas y cualquier huésped que busque un
            equilibrio entre comodidad, vista y accesibilidad.</p>
        </div>
        <div class="mt-6">
          <button @click="$refs['middle-details'].close()"
            class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
            Cerrar
          </button>
        </div>
      </div>
    </dialog>
  
    <dialog id="dialog-high-details" x-ref="high-details" class="p-0 rounded-lg shadow-xl max-w-md w-full">
      <div class="bg-white p-6 rounded-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Pisos Superiores</h3>
          <button @click="$refs['high-details'].close()" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="text-gray-700">
          <p class="mb-4">Disfrute de impresionantes vistas panorámicas desde nuestros pisos superiores. El ambiente es
            más exclusivo, silencioso y luminoso, ideal para una experiencia premium.</p>
  
          <h4 class="font-medium text-gray-900 mb-2">Ventajas de los Pisos Superiores:</h4>
          <ul class="list-disc pl-5 space-y-1 text-sm mb-4">
            <li>Vistas espectaculares de 360° del entorno</li>
            <li>Máxima privacidad y ambiente exclusivo</li>
            <li>Mínimo nivel de ruido para un descanso óptimo</li>
            <li>Mayor luminosidad natural</li>
            <li>Experiencia de hospedaje premium</li>
          </ul>
  
          <p class="text-sm italic">Perfecto para: Parejas en luna de miel, viajeros que buscan tranquilidad, y huéspedes
            que valoran las vistas panorámicas y la privacidad.</p>
        </div>
        <div class="mt-6">
          <button @click="$refs['high-details'].close()"
            class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
            Cerrar
          </button>
        </div>
      </div>
    </dialog>
  
    <dialog id="dialog-penthouse-details" x-ref="penthouse-details" class="p-0 rounded-lg shadow-xl max-w-md w-full">
      <div class="bg-white p-6 rounded-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Penthouse</h3>
          <button @click="$refs['penthouse-details'].close()" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="text-gray-700">
          <p class="mb-4">Nuestra opción más exclusiva. El penthouse ofrece la experiencia definitiva de lujo con servicio
            personalizado, vistas incomparables y amenidades premium.</p>
  
          <h4 class="font-medium text-gray-900 mb-2">Ventajas del Penthouse:</h4>
          <ul class="list-disc pl-5 space-y-1 text-sm mb-4">
            <li>Ubicación privilegiada en lo más alto del edificio</li>
            <li>Vistas panorámicas espectaculares de 360°</li>
            <li>Terraza privada con área de descanso al aire libre</li>
            <li>Servicio de mayordomo exclusivo disponible</li>
            <li>Máxima privacidad y seguridad</li>
            <li>Decoración y amenidades de lujo superior</li>
          </ul>
  
          <p class="text-sm italic">Perfecto para: Celebraciones especiales, lunas de miel, ocasiones memorables y
            huéspedes que buscan la experiencia más exclusiva y lujosa posible.</p>
        </div>
        <div class="mt-6">
          <button @click="$refs['penthouse-details'].close()"
            class="w-full py-2 text-center font-medium rounded bg-gray-800 text-white hover:bg-gray-700 transition-colors">
            Cerrar
          </button>
        </div>
      </div> -->
                </div>
                <!-- Room Customization Component -->
                <div class="section bg-white p-6 rounded-lg shadow-sm mt-6">
                    <div class="">
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">Elige tu número de habitación.</h1>
                        <p class="text-gray-600 mb-8">
                            Explora el hotel y elige la habitación exacta en la que te quieres alojar.
                        </p>
                    </div>
                    <div class="relative w-full overflow-auto h-[calc(100vh-48px)] md:h-auto">
                        <img src="https://hvdataprostgweu.blob.core.windows.net/renderimages/h305/views/01_main/01d77a02-b92f-4214-a87c-79920dcbeded/background.webp"
                            alt="Hotel exterior view" class="w-full h-full object-cover rounded-md"
                            onerror="this.src='https://cdnjs.cloudflare.com/ajax/libs/placeholder-loading/0.6.0/img/background.jpg'">
                    </div>
                </div>
                <!-- Special Offers Component -->
                <div class="section bg-white p-6 rounded-lg" x-data="{
    offers: [
      {
        id: 1,
        title: 'Baño de Spa: Relájate con Estilo',
        description: 'Disfruta de nuestras instalaciones de spa de lujo',
        price: 59.99,
        type: 'perStay',
        image: 'https://placehold.co/300x300',
      },
      {
        id: 2,
        title: 'Cena Gourmet: Delicias Culinarias',
        description: 'Experimenta sabores exquisitos y presentación',
        price: 99.00,
        type: 'perPerson',
        image: 'https://placehold.co/300x300',
      },
      {
        id: 3,
        title: 'Tours de Aventura: Explora la Naturaleza',
        description: 'Descubre emocionantes actividades al aire libre',
        price: 150.00,
        type: 'perNight',
        image: 'https://placehold.co/300x300',
      },
      {
        id: 4,
        title: 'Paquete Romántico',
        description: 'Detalles especiales para una estancia romántica memorable',
        price: 75.00,
        type: 'perStay',
        image: 'https://placehold.co/300x300',
      },
      {
        id: 5,
        title: 'Traslado al Aeropuerto',
        description: 'Transporte sin complicaciones al/desde el aeropuerto',
        price: 45.00,
        type: 'perPerson',
        image: 'https://placehold.co/300x300',
      },
      {
        id: 6,
        title: 'Paquete de Bienestar',
        description: 'Sesiones diarias de yoga y meditación',
        price: 120.00,
        type: 'perNight',
        image: 'https://placehold.co/300x300',
      },
    ],
    
    // Track selections for each offer
    selections: {
      1: { quantity: 2 },
      2: { quantity: 1, persons: 2 },
      3: { quantity: 1, nights: 3 },
      4: { quantity: 0 },
      5: { quantity: 0, persons: 1 },
      6: { quantity: 0, nights: 1 },
    },
    
    // Format price with euro symbol
    formatPrice(price) {
      return '€' + price.toFixed(2);
    },
    
    // Get unit label based on offer type
    getUnitLabel(type) {
      switch (type) {
        case 'perStay':
          return 'por estancia';
        case 'perPerson':
          return 'por persona';
        case 'perNight':
          return 'por noche';
        default:
          return '';
      }
    },
    
    // Calculate total for an offer
    calculateTotal(offer) {
      const id = offer.id;
      const selection = this.selections[id];
      
      if (selection.quantity === 0) return 0;
      
      switch (offer.type) {
        case 'perPerson':
          return offer.price * selection.quantity * (selection.persons || 1);
        case 'perNight':
          return offer.price * selection.quantity * (selection.nights || 1);
        default: // perStay
          return offer.price * selection.quantity;
      }
    },
    
    // Update quantity for an offer
    updateQuantity(id, change) {
      const newQuantity = Math.max(0, this.selections[id].quantity + change);
      this.selections[id].quantity = newQuantity;
    },
    
    // Book the offer (add to global store)
    bookOffer(id) {
      const offer = this.offers.find(o => o.id === id);
      const selection = this.selections[id];
      
      if (selection.quantity === 0) return;
      
      // Create the offer data
      const offerData = {
        id: offer.id,
        name: offer.title,
        price: this.calculateTotal(offer),
        quantity: selection.quantity,
        type: offer.type
      };
      
      // Add additional data based on type
      if (offer.type === 'perPerson') {
        offerData.persons = selection.persons || 1;
      }
      
      if (offer.type === 'perNight') {
        offerData.nights = selection.nights || 1;
      }
      
      // Add to store
      if (typeof $store !== 'undefined' && $store.booking) {
        $store.booking.updateSpecialOffer(offerData);
      } else {
        console.log('Booked offer:', offerData);
      }
    }
  }">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold mb-2">¡Ofertas especiales adaptadas para ti!</h2>
                        <p class="text-gray-600">Mejora tu estancia con estas experiencias exclusivas.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <template x-for="offer in offers" :key="offer.id">
                            <!-- Card Component -->
                            <div class="rounded border border-gray-200 bg-white overflow-hidden">
                                <!-- Image Container -->
                                <div class="flex items-center justify-center h-48 bg-gray-100">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                </div>

                                <!-- Content -->
                                <div class="p-4">
                                    <!-- Title and Description -->
                                    <h3 class="text-xl font-bold" x-text="offer.title"></h3>
                                    <p class="text-gray-600 mt-1" x-text="offer.description"></p>

                                    <!-- Price and Quantity -->
                                    <div class="mt-4 flex items-center justify-between">
                                        <div>
                                            <span class="text-xl font-bold" x-text="formatPrice(offer.price)"></span>
                                            <span class="text-gray-500 text-sm"
                                                x-text="getUnitLabel(offer.type)"></span>
                                        </div>

                                        <!-- Quantity Controls -->
                                        <div class="flex items-center">
                                            <button
                                                class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-md bg-white"
                                                @click="updateQuantity(offer.id, -1)">
                                                <span class="text-lg">−</span>
                                            </button>
                                            <span class="mx-3 w-6 text-center"
                                                x-text="selections[offer.id].quantity"></span>
                                            <button
                                                class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-md bg-white"
                                                @click="updateQuantity(offer.id, 1)">
                                                <span class="text-lg">+</span>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Per Person Controls -->
                                    <div x-show="offer.type === 'perPerson' && selections[offer.id].quantity > 0"
                                        class="mt-4">
                                        <label class="flex items-center text-sm text-gray-700 mb-1">
                                            Número de personas
                                        </label>
                                        <select x-model="selections[offer.id].persons"
                                            class="w-full py-2 px-3 border border-gray-300 rounded-md">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                        </select>
                                    </div>

                                    <!-- Per Night Controls -->
                                    <div x-show="offer.type === 'perNight' && selections[offer.id].quantity > 0"
                                        class="mt-4">
                                        <label class="flex items-center text-sm text-gray-700 mb-1">
                                            Número de noches
                                        </label>
                                        <select x-model="selections[offer.id].nights"
                                            class="w-full py-2 px-3 border border-gray-300 rounded-md">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                        </select>
                                    </div>

                                    <!-- Total -->
                                    <div x-show="selections[offer.id].quantity > 0"
                                        class="mt-4 bg-gray-100 p-3 rounded-md">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-700">Total:</span>
                                            <span class="font-bold" x-text="formatPrice(calculateTotal(offer))"></span>
                                        </div>
                                    </div>

                                    <!-- Book Now Button -->
                                    <div class="mt-4">
                                        <button @click="bookOffer(offer.id)"
                                            style="width: 100%; padding: 12px; margin-top: 8px; background-color: #111827; color: white; font-weight: 500; border-radius: 6px; display: block;">
                                            Reservar Ahora
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            <!-- Pricing Summary Panel Component -->
            <div class="border rounded-lg overflow-hidden bg-white h-fit shadow-sm w-[400px] sticky top-28" x-data="{
    // Local component state
    roomUpgrade: $store.booking.selectedRoom,
    customizations: $store.booking.getActiveCustomizations(),
    specialOffers: $store.booking.specialOffers,
    
    // Toast notification system
    toasts: [],
    showToast(message, type = 'success') {
      const id = Date.now();
      this.toasts.push({ id, message, type });
      
      // Auto-remove toast after 3 seconds
      setTimeout(() => {
        this.removeToast(id);
      }, 3000);
    },
    
    removeToast(id) {
      const index = this.toasts.findIndex(toast => toast.id === id);
      if (index !== -1) {
        this.toasts.splice(index, 1);
      }
    },
    
    // Subtotal calculation
    get subtotal() {
      return $store.booking.calculateTotal();
    },
    
    get taxes() {
      return $store.booking.calculateTaxes();
    },
    
    get total() {
      return this.subtotal + this.taxes;
    },
    
    removeCustomization(optionId, label) {
      // Find the category
      const category = Object.keys($store.booking.customizations).find(key => 
        $store.booking.customizations[key]?.id === optionId
      );
      
      if (category) {
        // Set it to null
        $store.booking.customizations[category] = null;
        
        // Force refresh of local data
        this.customizations = $store.booking.getActiveCustomizations();
        
        // Show toast notification
        this.showToast(`Se ha eliminado: ${label}`, 'info');
      }
    },
    
    removeSpecialOffer(offerId, offerName) {
      $store.booking.toggleSpecialOffer({id: offerId});
      this.showToast(`Se ha eliminado: ${offerName}`, 'info');
    },
    
    removeRoomUpgrade() {
      $store.booking.selectRoom({id: 'deluxe-double', name: 'Deluxe Double Room', price: 0});
      this.showToast('Se ha eliminado la mejora de habitación', 'info');
    },
    
    init() {
      // Watch for changes in the global store
      this.$watch('$store.booking.selectedRoom', (value, oldValue) => {
        this.roomUpgrade = value;
        if (oldValue && value.id !== oldValue.id) {
          if (value.id === 'deluxe-double') {
            // Downgrade notification
            this.showToast('Se ha eliminado la mejora de habitación', 'info');
          } else {
            // Upgrade notification
            this.showToast(`Se ha añadido: ${value.name}`, 'success');
          }
        }
      });
      
      // Deep watch for customizations
      this.$watch('$store.booking.customizations', (value, oldValue) => {
        const newCustomizations = $store.booking.getActiveCustomizations();
        
        // Check if items were added or removed
        if (newCustomizations.length > this.customizations.length) {
          // Find the new customization
          const newItem = newCustomizations.find(item => 
            !this.customizations.some(old => old.id === item.id)
          );
          if (newItem) {
            this.showToast(`Se ha añadido: ${newItem.label}`, 'success');
          }
        }
        
        this.customizations = newCustomizations;
      }, { deep: true });
      
      this.$watch('$store.booking.specialOffers', (value, oldValue) => {
        if (value.length > this.specialOffers.length) {
          // Find the new offer
          const newOffer = value.find(offer => 
            !this.specialOffers.some(old => old.id === offer.id)
          );
          if (newOffer) {
            this.showToast(`Se ha añadido: ${newOffer.name}`, 'success');
          }
        }
        this.specialOffers = value;
      });
    }
  }">
                <!-- Added hotel room image at the top -->
                <div class="w-full h-40 bg-gray-200 overflow-hidden">
                    <img src="https://hvdataprostgweu.blob.core.windows.net/renderimages/h305/views/01_main/01d77a02-b92f-4214-a87c-79920dcbeded/background.webp"
                        alt="Habitación de hotel" class="w-full h-full object-cover" />
                </div>

                <!-- Content container with padding -->
                <div class="p-4">

                    <!-- Room Selection Section -->
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-medium">Habitación seleccionada</h3>
                            <div class="flex items-center" x-show="roomUpgrade && roomUpgrade.id !== 'deluxe-double'">
                                <button class="text-sm text-gray-500 font-medium underline">Editar</button>
                                <button class="ml-2">
                                    <i data-lucide="pencil" class="h-4 w-4 text-gray-500"></i>
                                </button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center" x-show="roomUpgrade"
                            x-transition:enter="transition ease-out duration-300"
                            x-transition:enter-start="opacity-0 transform scale-95"
                            x-transition:enter-end="opacity-100 transform scale-100"
                            x-transition:leave="transition ease-in duration-200"
                            x-transition:leave-start="opacity-100 transform scale-100"
                            x-transition:leave-end="opacity-0 transform scale-95">
                            <span class="text-sm" x-text="roomUpgrade.name"></span>
                            <div class="flex items-center">
                                <span class="text-sm font-medium mr-1" x-show="roomUpgrade.price > 0">
                                    + <span x-text="roomUpgrade.price.toFixed(2)"></span> EUR
                                </span>
                                <button x-show="roomUpgrade.id !== 'deluxe-double'" @click="removeRoomUpgrade()"
                                    class="border border-gray-300 rounded-full h-5 w-5 flex items-center justify-center hover:bg-gray-100 transition-colors">
                                    -
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="h-[1px] w-full bg-gray-200 my-4"></div>

                    <!-- Room Customizations Section -->
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-medium">Información sobre mejoras</h3>
                            <div class="flex items-center" x-show="customizations.length > 0">
                                <button class="text-sm text-gray-500 font-medium underline">Editar</button>
                                <button class="ml-2">
                                    <i data-lucide="pencil" class="h-4 w-4 text-gray-500"></i>
                                </button>
                            </div>
                        </div>
                        <div class="space-y-2" x-show="customizations.length > 0">
                            <template x-for="(option, index) in customizations" :key="option.id">
                                <div class="flex justify-between items-center"
                                    x-transition:enter="transition ease-out duration-300"
                                    x-transition:enter-start="opacity-0 transform -translate-x-4"
                                    x-transition:enter-end="opacity-100 transform translate-x-0"
                                    x-transition:leave="transition ease-in duration-200"
                                    x-transition:leave-start="opacity-100 transform translate-x-0"
                                    x-transition:leave-end="opacity-0 transform -translate-x-4">
                                    <span class="text-sm" x-text="option.label"></span>
                                    <div class="flex items-center">
                                        <span class="text-sm font-medium mr-1" x-show="option.price > 0">+ <span
                                                x-text="option.price.toFixed(2)"></span> EUR</span>
                                        <button @click="removeCustomization(option.id, option.label)"
                                            class="border border-gray-300 rounded-full h-5 w-5 flex items-center justify-center hover:bg-gray-100 transition-colors">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="h-3 w-3">
                                                <path d="M5 12h14"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </template>
                        </div>
                        <div x-show="customizations.length === 0" class="text-sm text-gray-500 italic">
                            No hay mejoras seleccionadas
                        </div>
                    </div>

                    <!-- Special Offers Section -->
                    <div class="mb-4">
                        <div class="h-[1px] w-full bg-gray-200 my-4"></div>
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-medium">Ofertas especiales</h3>
                            <div class="flex items-center" x-show="specialOffers.length > 0">
                                <button class="text-sm text-gray-500 font-medium underline">Editar</button>
                                <button class="ml-2">
                                    <i data-lucide="pencil" class="h-4 w-4 text-gray-500"></i>
                                </button>
                            </div>
                        </div>
                        <div class="space-y-2" x-show="specialOffers.length > 0">
                            <template x-for="(offer, index) in specialOffers" :key="offer.id">
                                <div class="flex justify-between items-center"
                                    x-transition:enter="transition ease-out duration-300"
                                    x-transition:enter-start="opacity-0 transform -translate-x-4"
                                    x-transition:enter-end="opacity-100 transform translate-x-0"
                                    x-transition:leave="transition ease-in duration-200"
                                    x-transition:leave-start="opacity-100 transform translate-x-0"
                                    x-transition:leave-end="opacity-0 transform -translate-x-4">
                                    <span class="text-sm" x-text="offer.name"></span>
                                    <div class="flex items-center">
                                        <span class="text-sm font-medium mr-1" x-show="offer.price > 0">+ <span
                                                x-text="offer.price.toFixed(2)"></span> EUR</span>
                                        <button @click="removeSpecialOffer(offer.id, offer.name)"
                                            class="border border-gray-300 rounded-full h-5 w-5 flex items-center justify-center hover:bg-gray-100 transition-colors">
                                            -
                                        </button>
                                    </div>
                                </div>
                            </template>
                        </div>
                        <div x-show="specialOffers.length === 0" class="text-sm text-gray-500 italic">
                            No hay ofertas especiales seleccionadas
                        </div>
                    </div>

                    <div class="h-[1px] w-full bg-gray-200 my-4"></div>

                    <!-- Price Breakdown -->
                    <div class="space-y-2 mb-6">
                        <div class="flex justify-between">
                            <span>Subtotal</span>
                            <span><span x-text="subtotal.toFixed(2)"></span> EUR</span>
                        </div>
                        <div class="flex justify-between text-sm text-gray-600">
                            <span>Impuestos</span>
                            <span><span x-text="taxes.toFixed(2)"></span> EUR</span>
                        </div>
                        <div class="flex justify-between font-bold pt-2">
                            <span>Total final</span>
                            <span class="transition-all duration-500 ease-in-out"
                                :class="{'scale-110 text-blue-600': $store.booking.calculateTotal() !== subtotal}">
                                <span x-text="total.toFixed(2)"></span> EUR
                            </span>
                        </div>
                    </div>

                    <div class="h-[1px] w-full bg-gray-200 my-4"></div>

                    <!-- Tarifa information from screenshot -->
                    <div class="mb-4">

                        <div class="flex items-center mb-2">
                            <i data-lucide="credit-card" class="h-5 w-5 text-gray-500 mr-2"></i>
                            <span class="text-sm text-gray-600">Pagar en el hotel</span>
                        </div>

                        <div class="mt-1">
                            <a href="#" class="text-sm text-gray-500 font-medium underline">Ver condiciones</a>
                        </div>
                    </div>

                    <!-- Confirm Button -->
                    <button
                        class="inline-flex w-full items-center justify-center rounded-md text-sm font-medium bg-black hover:bg-black/90 text-white py-2 transition-colors">
                        Confirmar
                    </button>
                </div>

                <!-- Toast Container (Bottom Right) -->
                <div class="fixed bottom-4 right-4 z-50 space-y-2 w-72">
                    <template x-for="toast in toasts" :key="toast.id">
                        <div :class="{
                  'bg-white border-green-400 text-green-700': toast.type === 'success',
                  'bg-white border-blue-400 text-blue-700': toast.type === 'info',
                  'bg-white border-red-400 text-red-700': toast.type === 'error'
                }" class="border-l-4 p-3 rounded shadow-md flex items-start justify-between"
                            x-transition:enter="transition ease-out duration-300"
                            x-transition:enter-start="opacity-0 transform translate-y-2"
                            x-transition:enter-end="opacity-100 transform translate-y-0"
                            x-transition:leave="transition ease-in duration-200"
                            x-transition:leave-start="opacity-100 transform translate-y-0"
                            x-transition:leave-end="opacity-0 transform translate-y-2">
                            <div class="flex items-center">
                                <i data-lucide="check-circle" class="h-5 w-5 mr-2"
                                    x-show="toast.type === 'success'"></i>
                                <i data-lucide="info" class="h-5 w-5 mr-2" x-show="toast.type === 'info'"></i>
                                <i data-lucide="alert-triangle" class="h-5 w-5 mr-2"
                                    x-show="toast.type === 'error'"></i>
                                <span x-text="toast.message"></span>
                            </div>
                            <button @click="removeToast(toast.id)" class="text-gray-500 hover:text-gray-700">
                                <i data-lucide="x" class="h-4 w-4"></i>
                            </button>
                        </div>
                    </template>
                </div>
            </div>
        </section>

        <!-- Global State Script -->
        <script id="booking-state">
            // Global state management for the booking experience
            // Global state management for the booking experience
            document.addEventListener('alpine:init', () => {
                // Create a global store to share data between components
                Alpine.store('booking', {
                    // Default values
                    selectedRoom: {
                        id: 'deluxe-double',
                        name: 'Deluxe Double Room',
                        price: 0
                    },

                    // Room customizations
                    customizations: {
                        camas: null,  // Bed type
                        ubicacion: null, // Location
                        piso: null,   // Floor
                        vista: null   // View
                    },

                    // Selected special offers (enhanced to support quantity, persons, nights)
                    specialOffers: [],

                    // Methods to update selections
                    selectRoom(room) {
                        this.selectedRoom = {
                            id: room.id,
                            name: room.name,
                            price: room.price
                        };
                        this.updatePricingSummary();
                    },

                    toggleCustomization(category, option, price, label) {
                        if (this.customizations[category] &&
                            this.customizations[category].id === option) {
                            this.customizations[category] = null;
                        } else {
                            this.customizations[category] = {
                                id: option,
                                price: price,
                                label: label
                            };
                        }
                        this.updatePricingSummary();
                    },

                    // Updated method to add or update a special offer
                    updateSpecialOffer(offer) {
                        const index = this.specialOffers.findIndex(o => o.id === offer.id);

                        if (index >= 0) {
                            this.specialOffers[index] = offer;
                        } else {
                            this.specialOffers.push(offer);
                        }

                        this.updatePricingSummary();
                    },

                    // New method to remove a special offer
                    removeSpecialOffer(offerId) {
                        const index = this.specialOffers.findIndex(o => o.id === offerId);

                        if (index >= 0) {
                            this.specialOffers.splice(index, 1);
                            this.updatePricingSummary();
                        }
                    },

                    // Legacy method for backward compatibility
                    toggleSpecialOffer(offer) {
                        const index = this.specialOffers.findIndex(o => o.id === offer.id);

                        if (index >= 0) {
                            this.specialOffers.splice(index, 1);
                        } else {
                            this.specialOffers.push({
                                id: offer.id,
                                name: offer.title,
                                price: parseFloat(offer.price),
                                priceUnit: offer.priceUnit || 'per stay',
                                quantity: 1
                            });
                        }
                        this.updatePricingSummary();
                    },

                    // Method to trigger pricing summary update
                    updatePricingSummary() {
                        // This will be handled by the pricing-summary component itself
                        // We're just creating a method to explicitly show this intention
                    },

                    // Getter method for active customizations
                    getActiveCustomizations() {
                        return Object.values(this.customizations).filter(item => item !== null);
                    },

                    // Calculate total price
                    calculateTotal() {
                        // Base room price (from room selection)
                        let total = 299.00; // Base price before customizations

                        // Add room upgrade price if selected
                        if (this.selectedRoom && this.selectedRoom.price) {
                            total += this.selectedRoom.price;
                        }

                        // Add customization prices
                        Object.values(this.customizations).forEach(option => {
                            if (option && option.price) {
                                total += option.price;
                            }
                        });

                        // Add special offers - use the price that was calculated 
                        // with quantity, persons, and nights factored in
                        this.specialOffers.forEach(offer => {
                            if (offer && offer.price) {
                                total += offer.price;
                            }
                        });

                        return total;
                    },

                    // Calculate taxes (simplified as percentage of subtotal)
                    calculateTaxes() {
                        return this.calculateTotal() * 0.1; // 10% tax rate
                    }
                });
            });
        </script>

        <script>
            // Function to load HTML components
            async function loadComponent(elementId, filePath) {
                try {
                    const response = await fetch(filePath);
                    const html = await response.text();
                    document.getElementById(elementId).innerHTML = html;

                    // Re-initialize Lucide icons after loading each component
                    // Also, add this to reinitialize icons whenever Alpine.js updates the DOM
                    document.addEventListener('alpine:updating', () => {
                        setTimeout(() => lucide.createIcons(), 0);
                    });
                } catch (error) {
                    console.error(`Error loading ${filePath}:`, error);
                }
            }
        </script>

    </div>
</body>

</html>